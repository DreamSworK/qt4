<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Qt 4.8: /src/gui/image/qpnghandler.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="qt_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Qt 4.8
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_1427e6b9e14483d8a13b4ea1c69420e3.html">qt-4.8.6</a></li><li class="navelem"><a class="el" href="dir_42c0970699667688278d00b1a5e7112e.html">src</a></li><li class="navelem"><a class="el" href="dir_079600a9700e7f89459fcd6c0090021f.html">gui</a></li><li class="navelem"><a class="el" href="dir_811cede4207f017b329b79312644d2d3.html">image</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">qpnghandler.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;private/qpnghandler_p.h&quot;</code><br />
<code>#include &lt;<a class="el" href="qcoreapplication_8h_source.html">qcoreapplication.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="qiodevice_8h_source.html">qiodevice.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="qimage_8h_source.html">qimage.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="qlist_8h_source.html">qlist.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="qtextcodec_8h_source.html">qtextcodec.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="qvariant_8h_source.html">qvariant.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="qvector_8h_source.html">qvector.h</a>&gt;</code><br />
<code>#include &lt;png.h&gt;</code><br />
<code>#include &lt;pngconf.h&gt;</code><br />
</div>
<p><a href="qpnghandler_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classQPngHandlerPrivate.html">QPngHandlerPrivate</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classQPNGImageWriter.html">QPNGImageWriter</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3c8af42bf1f1f2b851da72c76e4a9042"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#a3c8af42bf1f1f2b851da72c76e4a9042">CALLBACK_CALL_TYPE</a>&#160;&#160;&#160;__cdecl</td></tr>
<tr class="separator:a3c8af42bf1f1f2b851da72c76e4a9042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4d39b9ef1162e761cd9a5736a739412"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#ad4d39b9ef1162e761cd9a5736a739412">FAST_SCAN_LINE</a>(<a class="el" href="qtextdocumentlayout_8cpp.html#ab7b1efe25cd1bb0ca06221ba1e213b61">data</a>,  bpl,  y)&#160;&#160;&#160;(<a class="el" href="qtextdocumentlayout_8cpp.html#ab7b1efe25cd1bb0ca06221ba1e213b61">data</a> + (y) * bpl)</td></tr>
<tr class="separator:ad4d39b9ef1162e761cd9a5736a739412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06ab9d197f8affe16c04808b24ffd021"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#a06ab9d197f8affe16c04808b24ffd021">Q_INTERNAL_WIN_NO_THROW</a></td></tr>
<tr class="separator:a06ab9d197f8affe16c04808b24ffd021"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae4918806f392c543626d8bc5da74c99e"><td class="memItemLeft" align="right" valign="top">static void <a class="el" href="qpnghandler_8cpp.html#a3c8af42bf1f1f2b851da72c76e4a9042">CALLBACK_CALL_TYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#ae4918806f392c543626d8bc5da74c99e">iod_read_fn</a> (png_structp png_ptr, png_bytep <a class="el" href="qtextdocumentlayout_8cpp.html#ab7b1efe25cd1bb0ca06221ba1e213b61">data</a>, png_size_t length)</td></tr>
<tr class="separator:ae4918806f392c543626d8bc5da74c99e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b70921c4d734c57f73d30cbe09d1b89"><td class="memItemLeft" align="right" valign="top">static void <a class="el" href="qpnghandler_8cpp.html#a3c8af42bf1f1f2b851da72c76e4a9042">CALLBACK_CALL_TYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#a8b70921c4d734c57f73d30cbe09d1b89">qpiw_flush_fn</a> (png_structp)</td></tr>
<tr class="separator:a8b70921c4d734c57f73d30cbe09d1b89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a456699365249fd91da09715822d8ae6c"><td class="memItemLeft" align="right" valign="top">static void <a class="el" href="qpnghandler_8cpp.html#a3c8af42bf1f1f2b851da72c76e4a9042">CALLBACK_CALL_TYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#a456699365249fd91da09715822d8ae6c">qpiw_write_fn</a> (png_structp png_ptr, png_bytep <a class="el" href="qtextdocumentlayout_8cpp.html#ab7b1efe25cd1bb0ca06221ba1e213b61">data</a>, png_size_t length)</td></tr>
<tr class="separator:a456699365249fd91da09715822d8ae6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53d6f943203094049614b41ee6881cb2"><td class="memItemLeft" align="right" valign="top">static void <a class="el" href="qpnghandler_8cpp.html#a3c8af42bf1f1f2b851da72c76e4a9042">CALLBACK_CALL_TYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#a53d6f943203094049614b41ee6881cb2">qt_png_warning</a> (png_structp, png_const_charp message)</td></tr>
<tr class="separator:a53d6f943203094049614b41ee6881cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299f733b42ded1ad857b7b65dfd82c66"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#a299f733b42ded1ad857b7b65dfd82c66">set_text</a> (const <a class="el" href="classQImage.html">QImage</a> &amp;image, png_structp png_ptr, png_infop info_ptr, const <a class="el" href="classQString.html">QString</a> &amp;description)</td></tr>
<tr class="separator:a299f733b42ded1ad857b7b65dfd82c66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51da633e05bc6b0b5a2f583ae41ab808"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#a51da633e05bc6b0b5a2f583ae41ab808">setup_qt</a> (<a class="el" href="classQImage.html">QImage</a> &amp;image, png_structp png_ptr, png_infop info_ptr, float screen_gamma=0.0)</td></tr>
<tr class="separator:a51da633e05bc6b0b5a2f583ae41ab808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a351991c84ebb236197d535e32be7cc32"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qpnghandler_8cpp.html#a351991c84ebb236197d535e32be7cc32">write_png_image</a> (const <a class="el" href="classQImage.html">QImage</a> &amp;image, <a class="el" href="classQIODevice.html">QIODevice</a> *device, int quality, float gamma, const <a class="el" href="classQString.html">QString</a> &amp;description)</td></tr>
<tr class="separator:a351991c84ebb236197d535e32be7cc32"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3c8af42bf1f1f2b851da72c76e4a9042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c8af42bf1f1f2b851da72c76e4a9042">&#9670;&nbsp;</a></span>CALLBACK_CALL_TYPE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALLBACK_CALL_TYPE&#160;&#160;&#160;__cdecl</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00085">85</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

</div>
</div>
<a id="ad4d39b9ef1162e761cd9a5736a739412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4d39b9ef1162e761cd9a5736a739412">&#9670;&nbsp;</a></span>FAST_SCAN_LINE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAST_SCAN_LINE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="qtextdocumentlayout_8cpp.html#ab7b1efe25cd1bb0ca06221ba1e213b61">data</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bpl, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(<a class="el" href="qtextdocumentlayout_8cpp.html#ab7b1efe25cd1bb0ca06221ba1e213b61">data</a> + (y) * bpl)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00099">99</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="qpnghandler_8cpp_source.html#l00464">QPngHandlerPrivate::readPngImage()</a>.</p>

</div>
</div>
<a id="a06ab9d197f8affe16c04808b24ffd021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06ab9d197f8affe16c04808b24ffd021">&#9670;&nbsp;</a></span>Q_INTERNAL_WIN_NO_THROW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Q_INTERNAL_WIN_NO_THROW</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00095">95</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae4918806f392c543626d8bc5da74c99e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4918806f392c543626d8bc5da74c99e">&#9670;&nbsp;</a></span>iod_read_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="qpnghandler_8cpp.html#a3c8af42bf1f1f2b851da72c76e4a9042">CALLBACK_CALL_TYPE</a> iod_read_fn </td>
          <td>(</td>
          <td class="paramtype">png_structp&#160;</td>
          <td class="paramname"><em>png_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">png_bytep&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">png_size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00179">179</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="qpnghandler_8cpp_source.html#l00423">QPngHandlerPrivate::readPngHeader()</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classQPngHandlerPrivate.html">QPngHandlerPrivate</a> *<a class="code" href="qnumeric__p_8h.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = (<a class="code" href="classQPngHandlerPrivate.html">QPngHandlerPrivate</a> *)png_get_io_ptr(png_ptr);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="classQIODevice.html">QIODevice</a> *in = d-&gt;<a class="code" href="classQPngHandlerPrivate.html#a2c53d4327eccd19eee152ba3cccc0fec">q</a>-&gt;<a class="code" href="classQImageIOHandler.html#ac987558b6b4ef972f3fdde97bfc98587">device</a>();</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (d-&gt;<a class="code" href="classQPngHandlerPrivate.html#a1214ee5a629e43e39c283ccfe3a4fcec">state</a> == <a class="code" href="classQPngHandlerPrivate.html#a488f07c52d9106caff5f269a5ff107d3a7848a80134f165ba69412d1eeee8fb73">QPngHandlerPrivate::ReadingEnd</a> &amp;&amp; !in-&gt;<a class="code" href="classQIODevice.html#a1a3ea1b8b339d7fdb8e675fe48579f56">isSequential</a>() &amp;&amp; (in-&gt;<a class="code" href="classQIODevice.html#a120f9ea2d48acaa42f179a41494e1bf2">size</a>() - in-&gt;<a class="code" href="classQIODevice.html#a1537dd2eaacf74faa074694ee0ccb6b7">pos</a>()) &lt; 4 &amp;&amp; length == 4) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">// Workaround for certain malformed PNGs that lack the final crc bytes</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="qglobal_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> endcrc[4] = { 0xae, 0x42, 0x60, 0x82 };</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="qglobal_8cpp.html#ae4bd807114044d9ba6870855d3fe2462">qMemCopy</a>(<a class="code" href="qdbusmessage_8cpp.html#a4b86149e51ff4431f59ce6148820fb86">data</a>, endcrc, 4);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        in-&gt;<a class="code" href="classQIODevice.html#ac0a82d036b837f4a10469fc07e1d8e99">seek</a>(in-&gt;<a class="code" href="classQIODevice.html#a120f9ea2d48acaa42f179a41494e1bf2">size</a>());</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">while</span> (length) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordtype">int</span> nr = in-&gt;<a class="code" href="classQIODevice.html#af6656035ec4464bcc2a599bb25ac235a">read</a>((<span class="keywordtype">char</span>*)<a class="code" href="qdbusmessage_8cpp.html#a4b86149e51ff4431f59ce6148820fb86">data</a>, length);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (nr &lt;= 0) {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            png_error(png_ptr, <span class="stringliteral">&quot;Read Error&quot;</span>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        length -= nr;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="ttc" id="qnumeric__p_8h_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="qnumeric__p_8h.html#a873684cefeb665f3d5e6b495de57fc0d">d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="qnumeric__p_8h_source.html#l00062">qnumeric_p.h:62</a></div></div>
<div class="ttc" id="classQIODevice_html_a120f9ea2d48acaa42f179a41494e1bf2"><div class="ttname"><a href="classQIODevice.html#a120f9ea2d48acaa42f179a41494e1bf2">QIODevice::size</a></div><div class="ttdeci">virtual qint64 size() const</div><div class="ttdoc">For open random-access devices, this function returns the size of the device. </div><div class="ttdef"><b>Definition:</b> <a href="qiodevice_8cpp_source.html#l00642">qiodevice.cpp:642</a></div></div>
<div class="ttc" id="classQPngHandlerPrivate_html_a2c53d4327eccd19eee152ba3cccc0fec"><div class="ttname"><a href="classQPngHandlerPrivate.html#a2c53d4327eccd19eee152ba3cccc0fec">QPngHandlerPrivate::q</a></div><div class="ttdeci">QPngHandler * q</div><div class="ttdef"><b>Definition:</b> <a href="qpnghandler_8cpp_source.html#l00141">qpnghandler.cpp:141</a></div></div>
<div class="ttc" id="classQIODevice_html_a1537dd2eaacf74faa074694ee0ccb6b7"><div class="ttname"><a href="classQIODevice.html#a1537dd2eaacf74faa074694ee0ccb6b7">QIODevice::pos</a></div><div class="ttdeci">virtual qint64 pos() const</div><div class="ttdoc">For random-access devices, this function returns the position that data is written to or read from...</div><div class="ttdef"><b>Definition:</b> <a href="qiodevice_8cpp_source.html#l00624">qiodevice.cpp:624</a></div></div>
<div class="ttc" id="classQPngHandlerPrivate_html_a488f07c52d9106caff5f269a5ff107d3a7848a80134f165ba69412d1eeee8fb73"><div class="ttname"><a href="classQPngHandlerPrivate.html#a488f07c52d9106caff5f269a5ff107d3a7848a80134f165ba69412d1eeee8fb73">QPngHandlerPrivate::ReadingEnd</a></div><div class="ttdef"><b>Definition:</b> <a href="qpnghandler_8cpp_source.html#l00114">qpnghandler.cpp:114</a></div></div>
<div class="ttc" id="classQIODevice_html_af6656035ec4464bcc2a599bb25ac235a"><div class="ttname"><a href="classQIODevice.html#af6656035ec4464bcc2a599bb25ac235a">QIODevice::read</a></div><div class="ttdeci">qint64 read(char *data, qint64 maxlen)</div><div class="ttdoc">Reads at most maxSize bytes from the device into data, and returns the number of bytes read...</div><div class="ttdef"><b>Definition:</b> <a href="qiodevice_8cpp_source.html#l00791">qiodevice.cpp:791</a></div></div>
<div class="ttc" id="qglobal_8h_html_a65f85814a8290f9797005d3b28e7e5fc"><div class="ttname"><a href="qglobal_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a></div><div class="ttdeci">unsigned char uchar</div><div class="ttdef"><b>Definition:</b> <a href="qglobal_8h_source.html#l00994">qglobal.h:994</a></div></div>
<div class="ttc" id="qdbusmessage_8cpp_html_a4b86149e51ff4431f59ce6148820fb86"><div class="ttname"><a href="qdbusmessage_8cpp.html#a4b86149e51ff4431f59ce6148820fb86">data</a></div><div class="ttdeci">static const char * data(const QByteArray &amp;arr)</div><div class="ttdef"><b>Definition:</b> <a href="qdbusmessage_8cpp_source.html#l00060">qdbusmessage.cpp:60</a></div></div>
<div class="ttc" id="classQPngHandlerPrivate_html_a1214ee5a629e43e39c283ccfe3a4fcec"><div class="ttname"><a href="classQPngHandlerPrivate.html#a1214ee5a629e43e39c283ccfe3a4fcec">QPngHandlerPrivate::state</a></div><div class="ttdeci">State state</div><div class="ttdef"><b>Definition:</b> <a href="qpnghandler_8cpp_source.html#l00139">qpnghandler.cpp:139</a></div></div>
<div class="ttc" id="classQIODevice_html_a1a3ea1b8b339d7fdb8e675fe48579f56"><div class="ttname"><a href="classQIODevice.html#a1a3ea1b8b339d7fdb8e675fe48579f56">QIODevice::isSequential</a></div><div class="ttdeci">virtual bool isSequential() const</div><div class="ttdoc">Returns true if this device is sequential; otherwise returns false. </div><div class="ttdef"><b>Definition:</b> <a href="qiodevice_8cpp_source.html#l00454">qiodevice.cpp:454</a></div></div>
<div class="ttc" id="qglobal_8cpp_html_ae4bd807114044d9ba6870855d3fe2462"><div class="ttname"><a href="qglobal_8cpp.html#ae4bd807114044d9ba6870855d3fe2462">qMemCopy</a></div><div class="ttdeci">void * qMemCopy(void *dest, const void *src, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="qglobal_8cpp_source.html#l02508">qglobal.cpp:2508</a></div></div>
<div class="ttc" id="classQPngHandlerPrivate_html"><div class="ttname"><a href="classQPngHandlerPrivate.html">QPngHandlerPrivate</a></div><div class="ttdef"><b>Definition:</b> <a href="qpnghandler_8cpp_source.html#l00108">qpnghandler.cpp:108</a></div></div>
<div class="ttc" id="classQImageIOHandler_html_ac987558b6b4ef972f3fdde97bfc98587"><div class="ttname"><a href="classQImageIOHandler.html#ac987558b6b4ef972f3fdde97bfc98587">QImageIOHandler::device</a></div><div class="ttdeci">QIODevice * device() const</div><div class="ttdoc">Returns the device currently assigned to the QImageIOHandler. </div><div class="ttdef"><b>Definition:</b> <a href="qimageiohandler_8cpp_source.html#l00314">qimageiohandler.cpp:314</a></div></div>
<div class="ttc" id="classQIODevice_html"><div class="ttname"><a href="classQIODevice.html">QIODevice</a></div><div class="ttdoc">The QIODevice class is the base interface class of all I/O devices in Qt. </div><div class="ttdef"><b>Definition:</b> <a href="qiodevice_8h_source.html#l00066">qiodevice.h:66</a></div></div>
<div class="ttc" id="classQIODevice_html_ac0a82d036b837f4a10469fc07e1d8e99"><div class="ttname"><a href="classQIODevice.html#ac0a82d036b837f4a10469fc07e1d8e99">QIODevice::seek</a></div><div class="ttdeci">virtual bool seek(qint64 pos)</div><div class="ttdoc">For random-access devices, this function sets the current position to pos, returning true on success...</div><div class="ttdef"><b>Definition:</b> <a href="qiodevice_8cpp_source.html#l00659">qiodevice.cpp:659</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b70921c4d734c57f73d30cbe09d1b89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b70921c4d734c57f73d30cbe09d1b89">&#9670;&nbsp;</a></span>qpiw_flush_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="qpnghandler_8cpp.html#a3c8af42bf1f1f2b851da72c76e4a9042">CALLBACK_CALL_TYPE</a> qpiw_flush_fn </td>
          <td>(</td>
          <td class="paramtype">png_structp&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00218">218</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="qpnghandler_8cpp_source.html#l00729">QPNGImageWriter::writeImage()</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;{</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a456699365249fd91da09715822d8ae6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a456699365249fd91da09715822d8ae6c">&#9670;&nbsp;</a></span>qpiw_write_fn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="qpnghandler_8cpp.html#a3c8af42bf1f1f2b851da72c76e4a9042">CALLBACK_CALL_TYPE</a> qpiw_write_fn </td>
          <td>(</td>
          <td class="paramtype">png_structp&#160;</td>
          <td class="paramname"><em>png_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">png_bytep&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">png_size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00204">204</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="qpnghandler_8cpp_source.html#l00729">QPNGImageWriter::writeImage()</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="classQPNGImageWriter.html">QPNGImageWriter</a>* qpiw = (<a class="code" href="classQPNGImageWriter.html">QPNGImageWriter</a>*)png_get_io_ptr(png_ptr);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classQIODevice.html">QIODevice</a>* out = qpiw-&gt;<a class="code" href="classQPNGImageWriter.html#a42b504b49d72b5a2cc19610f0bf5fac7">device</a>();</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="qglobal_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nr = out-&gt;<a class="code" href="classQIODevice.html#a70a53a0abd1961e2a9e1906623b70d57">write</a>((<span class="keywordtype">char</span>*)<a class="code" href="qdbusmessage_8cpp.html#a4b86149e51ff4431f59ce6148820fb86">data</a>, length);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span> (nr != length) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        png_error(png_ptr, <span class="stringliteral">&quot;Write Error&quot;</span>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div><div class="ttc" id="classQPNGImageWriter_html"><div class="ttname"><a href="classQPNGImageWriter.html">QPNGImageWriter</a></div><div class="ttdef"><b>Definition:</b> <a href="qpnghandler_8cpp_source.html#l00149">qpnghandler.cpp:149</a></div></div>
<div class="ttc" id="qdbusmessage_8cpp_html_a4b86149e51ff4431f59ce6148820fb86"><div class="ttname"><a href="qdbusmessage_8cpp.html#a4b86149e51ff4431f59ce6148820fb86">data</a></div><div class="ttdeci">static const char * data(const QByteArray &amp;arr)</div><div class="ttdef"><b>Definition:</b> <a href="qdbusmessage_8cpp_source.html#l00060">qdbusmessage.cpp:60</a></div></div>
<div class="ttc" id="qglobal_8h_html_a91ad9478d81a7aaf2593e8d9c3d06a14"><div class="ttname"><a href="qglobal_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition:</b> <a href="qglobal_8h_source.html#l00996">qglobal.h:996</a></div></div>
<div class="ttc" id="classQPNGImageWriter_html_a42b504b49d72b5a2cc19610f0bf5fac7"><div class="ttname"><a href="classQPNGImageWriter.html#a42b504b49d72b5a2cc19610f0bf5fac7">QPNGImageWriter::device</a></div><div class="ttdeci">QIODevice * device()</div><div class="ttdef"><b>Definition:</b> <a href="qpnghandler_8cpp_source.html#l00167">qpnghandler.cpp:167</a></div></div>
<div class="ttc" id="classQIODevice_html_a70a53a0abd1961e2a9e1906623b70d57"><div class="ttname"><a href="classQIODevice.html#a70a53a0abd1961e2a9e1906623b70d57">QIODevice::write</a></div><div class="ttdeci">qint64 write(const char *data, qint64 len)</div><div class="ttdoc">Writes at most maxSize bytes of data from data to the device. </div><div class="ttdef"><b>Definition:</b> <a href="qiodevice_8cpp_source.html#l01342">qiodevice.cpp:1342</a></div></div>
<div class="ttc" id="classQIODevice_html"><div class="ttname"><a href="classQIODevice.html">QIODevice</a></div><div class="ttdoc">The QIODevice class is the base interface class of all I/O devices in Qt. </div><div class="ttdef"><b>Definition:</b> <a href="qiodevice_8h_source.html#l00066">qiodevice.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53d6f943203094049614b41ee6881cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53d6f943203094049614b41ee6881cb2">&#9670;&nbsp;</a></span>qt_png_warning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="qpnghandler_8cpp.html#a3c8af42bf1f1f2b851da72c76e4a9042">CALLBACK_CALL_TYPE</a> qt_png_warning </td>
          <td>(</td>
          <td class="paramtype">png_structp&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">png_const_charp&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00378">378</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="qpnghandler_8cpp_source.html#l00423">QPngHandlerPrivate::readPngHeader()</a>, and <a class="el" href="qpnghandler_8cpp_source.html#l00729">QPNGImageWriter::writeImage()</a>.</p>
<div class="fragment"><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;{</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="qglobal_8h.html#ac70e1c2698aa808d9baf4bda9e9ee891">qWarning</a>(<span class="stringliteral">&quot;libpng warning: %s&quot;</span>, message);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div><div class="ttc" id="qglobal_8h_html_ac70e1c2698aa808d9baf4bda9e9ee891"><div class="ttname"><a href="qglobal_8h.html#ac70e1c2698aa808d9baf4bda9e9ee891">qWarning</a></div><div class="ttdeci">Q_CORE_EXPORT void qWarning(const char *,...)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a299f733b42ded1ad857b7b65dfd82c66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299f733b42ded1ad857b7b65dfd82c66">&#9670;&nbsp;</a></span>set_text()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_text </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classQImage.html">QImage</a> &amp;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">png_structp&#160;</td>
          <td class="paramname"><em>png_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">png_infop&#160;</td>
          <td class="paramname"><em>info_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classQString.html">QString</a> &amp;&#160;</td>
          <td class="paramname"><em>description</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00649">649</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="qpnghandler_8cpp_source.html#l00729">QPNGImageWriter::writeImage()</a>.</p>
<div class="fragment"><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;{</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="classQMap.html">QMap&lt;QString, QString&gt;</a> <a class="code" href="qobjectdefs_8h.html#a1144b296168b3bd3f9c04d75f4d5b94c">text</a>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">foreach</span> (<span class="keyword">const</span> <a class="code" href="classQString.html">QString</a> &amp;<a class="code" href="qkeysequence_8cpp.html#a35af0be900467fedbb610bd6ea65ed78">key</a>, image.<a class="code" href="classQImage.html#ab0ac9ecde8a77a33d302d5f7485e9db3">textKeys</a>()) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">if</span> (!key.<a class="code" href="classQString.html#aa032d4b5892338beb575a85e59bbbf38">isEmpty</a>())</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            text.<a class="code" href="classQMap.html#a0cc56ab47ea14af1127ac7399814d289">insert</a>(key, image.<a class="code" href="classQImage.html#ad1da4ec20201a5f468b4af8c8e7e1b11">text</a>(key));</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">foreach</span> (<span class="keyword">const</span> <a class="code" href="classQString.html">QString</a> &amp;pair, description.<a class="code" href="classQString.html#a523a85a2871b7d22ea87afc82c0733ed">split</a>(<a class="code" href="classQLatin1String.html">QLatin1String</a>(<span class="stringliteral">&quot;\n\n&quot;</span>))) {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="qfontsubset_8cpp.html#a83028518b8b40ed14c1c522b71d2eaa4">index</a> = pair.<a class="code" href="classQString.html#afffb887b72dd3ae599f1e6205c5248d9">indexOf</a>(<a class="code" href="structQLatin1Char.html">QLatin1Char</a>(<span class="charliteral">&#39;:&#39;</span>));</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (index &gt;= 0 &amp;&amp; pair.<a class="code" href="classQString.html#afffb887b72dd3ae599f1e6205c5248d9">indexOf</a>(<a class="code" href="structQLatin1Char.html">QLatin1Char</a>(<span class="charliteral">&#39; &#39;</span>)) &lt; <a class="code" href="qfontsubset_8cpp.html#a83028518b8b40ed14c1c522b71d2eaa4">index</a>) {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <a class="code" href="classQString.html">QString</a> s = pair.<a class="code" href="classQString.html#a9c2a096c813373c11643e07e7c23680b">simplified</a>();</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keywordflow">if</span> (!s.<a class="code" href="classQString.html#aa032d4b5892338beb575a85e59bbbf38">isEmpty</a>())</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                text.<a class="code" href="classQMap.html#a0cc56ab47ea14af1127ac7399814d289">insert</a>(<a class="code" href="classQLatin1String.html">QLatin1String</a>(<span class="stringliteral">&quot;Description&quot;</span>), s);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <a class="code" href="classQString.html">QString</a> key = pair.<a class="code" href="classQString.html#a8ac5c7669060295d274a0db1c9bcb5ca">left</a>(index);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordflow">if</span> (!key.<a class="code" href="classQString.html#a9c2a096c813373c11643e07e7c23680b">simplified</a>().<a class="code" href="classQString.html#aa032d4b5892338beb575a85e59bbbf38">isEmpty</a>())</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                text.<a class="code" href="classQMap.html#a0cc56ab47ea14af1127ac7399814d289">insert</a>(key, pair.<a class="code" href="classQString.html#a0e3c8883986091e3e82971b0574fd882">mid</a>(index + 2).<a class="code" href="classQString.html#a9c2a096c813373c11643e07e7c23680b">simplified</a>());</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    }</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">if</span> (text.<a class="code" href="classQMap.html#a6f715bb4c9b621f97a361eeb92909999">isEmpty</a>())</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    png_textp text_ptr = <span class="keyword">new</span> png_text[text.<a class="code" href="classQMap.html#a516d8e8f0ffb7cd13ec43fd4a19fbc9d">size</a>()];</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="qglobal_8cpp.html#a582bacdb83f410a321e8c00381d6a118">qMemSet</a>(text_ptr, 0, text.<a class="code" href="classQMap.html#a516d8e8f0ffb7cd13ec43fd4a19fbc9d">size</a>() * <span class="keyword">sizeof</span>(png_text));</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <a class="code" href="classQMap.html">QMap&lt;QString, QString&gt;::ConstIterator</a> <a class="code" href="qbuiltintypes_8cpp.html#a4e07b4d2e18ae9aeb657c68498982966">it</a> = text.<a class="code" href="classQMap.html#ad25d319573e19f3882c9856a3175842f">constBegin</a>();</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">while</span> (it != text.<a class="code" href="classQMap.html#af3ce3c91a2c9b4fde417378d7eaef0f2">constEnd</a>()) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        text_ptr[i].key = <a class="code" href="classQByteArray.html#ad8db86227c79f8e8d76811cd2f8aa190">qstrdup</a>(it.<a class="code" href="classQMap.html#a8fbb6ac66313887563fc8771590b08a9">key</a>().<a class="code" href="classQString.html#a8ac5c7669060295d274a0db1c9bcb5ca">left</a>(79).<a class="code" href="classQString.html#a9491884b49163344c4a03c738125f93d">toLatin1</a>().<a class="code" href="classQByteArray.html#adb3b4e935f60dd123b1b017894901937">constData</a>());</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordtype">bool</span> noCompress = (it.<a class="code" href="classQMap.html#aacd06ee00e923d9441fde192907f9220">value</a>().<a class="code" href="classQString.html#aa76f67fbfffab7285b75e56cc2270c37">length</a>() &lt; 40);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="preprocessor">#ifdef PNG_iTXt_SUPPORTED</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordtype">bool</span> needsItxt = <span class="keyword">false</span>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">foreach</span>(<span class="keyword">const</span> <a class="code" href="classQChar.html">QChar</a> <a class="code" href="qnumeric__p_8h.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a>, it.<a class="code" href="classQMap.html#aacd06ee00e923d9441fde192907f9220">value</a>()) {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <a class="code" href="qglobal_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> ch = c.<a class="code" href="classQChar.html#a44b4ebc60a4263918bf8f0dfcea49fa6">cell</a>();</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">if</span> (c.<a class="code" href="classQChar.html#a34a593cf210ef1ab09e09be78bf8ef3e">row</a>() || (ch &lt; 0x20 &amp;&amp; ch != &#39;\n&#39;) || (ch &gt; 0x7e &amp;&amp; ch &lt; 0xa0)) {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                needsItxt = <span class="keyword">true</span>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">if</span> (needsItxt) {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            text_ptr[i].compression = noCompress ? PNG_ITXT_COMPRESSION_NONE : PNG_ITXT_COMPRESSION_zTXt;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <a class="code" href="classQByteArray.html">QByteArray</a> value = it.<a class="code" href="classQMap.html#aacd06ee00e923d9441fde192907f9220">value</a>().<a class="code" href="classQString.html#abfcbb02434abf1a7fcccf13f090bd5a2">toUtf8</a>();</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            text_ptr[i].text = <a class="code" href="classQByteArray.html#ad8db86227c79f8e8d76811cd2f8aa190">qstrdup</a>(value.<a class="code" href="classQByteArray.html#adb3b4e935f60dd123b1b017894901937">constData</a>());</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            text_ptr[i].itxt_length = value.<a class="code" href="classQByteArray.html#a0cd331ee1b05147f3173fb85dfcd0ccd">size</a>();</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            text_ptr[i].lang = <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<span class="stringliteral">&quot;UTF-8&quot;</span>);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            text_ptr[i].lang_key = <a class="code" href="classQByteArray.html#ad8db86227c79f8e8d76811cd2f8aa190">qstrdup</a>(it.<a class="code" href="classQMap.html#a8fbb6ac66313887563fc8771590b08a9">key</a>().<a class="code" href="classQString.html#abfcbb02434abf1a7fcccf13f090bd5a2">toUtf8</a>().<a class="code" href="classQByteArray.html#adb3b4e935f60dd123b1b017894901937">constData</a>());</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            text_ptr[i].compression = noCompress ? PNG_TEXT_COMPRESSION_NONE : PNG_TEXT_COMPRESSION_zTXt;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <a class="code" href="classQByteArray.html">QByteArray</a> value = it.<a class="code" href="classQMap.html#aacd06ee00e923d9441fde192907f9220">value</a>().<a class="code" href="classQString.html#a9491884b49163344c4a03c738125f93d">toLatin1</a>();</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            text_ptr[i].text = <a class="code" href="classQByteArray.html#ad8db86227c79f8e8d76811cd2f8aa190">qstrdup</a>(value.<a class="code" href="classQByteArray.html#adb3b4e935f60dd123b1b017894901937">constData</a>());</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            text_ptr[i].text_length = value.<a class="code" href="classQByteArray.html#a0cd331ee1b05147f3173fb85dfcd0ccd">size</a>();</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        ++i;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        ++<a class="code" href="qbuiltintypes_8cpp.html#a4e07b4d2e18ae9aeb657c68498982966">it</a>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    png_set_text(png_ptr, info_ptr, text_ptr, i);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; text.<a class="code" href="classQMap.html#a516d8e8f0ffb7cd13ec43fd4a19fbc9d">size</a>(); ++i) {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keyword">delete</span> [] text_ptr[i].key;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keyword">delete</span> [] text_ptr[i].text;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="preprocessor">#ifdef PNG_iTXt_SUPPORTED</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keyword">delete</span> [] text_ptr[i].lang_key;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keyword">delete</span> [] text_ptr;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div><div class="ttc" id="qnumeric__p_8h_html_aa8bc5d06b176e45541cdfaf9c2c9dfea"><div class="ttname"><a href="qnumeric__p_8h.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a></div><div class="ttdeci">unsigned char c[8]</div><div class="ttdef"><b>Definition:</b> <a href="qnumeric__p_8h_source.html#l00062">qnumeric_p.h:62</a></div></div>
<div class="ttc" id="classQMap_html_a8fbb6ac66313887563fc8771590b08a9"><div class="ttname"><a href="classQMap.html#a8fbb6ac66313887563fc8771590b08a9">QMap::key</a></div><div class="ttdeci">const Key key(const T &amp;value) const</div><div class="ttdoc">Returns the first key with value value. </div><div class="ttdef"><b>Definition:</b> <a href="qmap_8h_source.html#l00844">qmap.h:844</a></div></div>
<div class="ttc" id="qbuiltintypes_8cpp_html_a4e07b4d2e18ae9aeb657c68498982966"><div class="ttname"><a href="qbuiltintypes_8cpp.html#a4e07b4d2e18ae9aeb657c68498982966">it</a></div><div class="ttdeci">#define it(className, varName)</div><div class="ttdef"><b>Definition:</b> <a href="qbuiltintypes_8cpp_source.html#l00095">qbuiltintypes.cpp:95</a></div></div>
<div class="ttc" id="classQString_html_abfcbb02434abf1a7fcccf13f090bd5a2"><div class="ttname"><a href="classQString.html#abfcbb02434abf1a7fcccf13f090bd5a2">QString::toUtf8</a></div><div class="ttdeci">QByteArray toUtf8() const Q_REQUIRED_RESULT</div><div class="ttdoc">Returns a UTF-8 representation of the string as a QByteArray. </div><div class="ttdef"><b>Definition:</b> <a href="qstring_8cpp_source.html#l04074">qstring.cpp:4074</a></div></div>
<div class="ttc" id="classQByteArray_html"><div class="ttname"><a href="classQByteArray.html">QByteArray</a></div><div class="ttdoc">The QByteArray class provides an array of bytes. </div><div class="ttdef"><b>Definition:</b> <a href="qbytearray_8h_source.html#l00135">qbytearray.h:135</a></div></div>
<div class="ttc" id="classQString_html_aa76f67fbfffab7285b75e56cc2270c37"><div class="ttname"><a href="classQString.html#aa76f67fbfffab7285b75e56cc2270c37">QString::length</a></div><div class="ttdeci">int length() const</div><div class="ttdoc">Returns the number of characters in this string. </div><div class="ttdef"><b>Definition:</b> <a href="qstring_8h_source.html#l00696">qstring.h:696</a></div></div>
<div class="ttc" id="classQMap_html_a516d8e8f0ffb7cd13ec43fd4a19fbc9d"><div class="ttname"><a href="classQMap.html#a516d8e8f0ffb7cd13ec43fd4a19fbc9d">QMap::size</a></div><div class="ttdeci">int size() const</div><div class="ttdoc">Returns the number of (key, value) pairs in the map. </div><div class="ttdef"><b>Definition:</b> <a href="qmap_8h_source.html#l00201">qmap.h:201</a></div></div>
<div class="ttc" id="classQString_html"><div class="ttname"><a href="classQString.html">QString</a></div><div class="ttdoc">The QString class provides a Unicode character string. </div><div class="ttdef"><b>Definition:</b> <a href="qstring_8h_source.html#l00083">qstring.h:83</a></div></div>
<div class="ttc" id="classQChar_html"><div class="ttname"><a href="classQChar.html">QChar</a></div><div class="ttdoc">The QChar class provides a 16-bit Unicode character. </div><div class="ttdef"><b>Definition:</b> <a href="qchar_8h_source.html#l00072">qchar.h:72</a></div></div>
<div class="ttc" id="qglobal_8h_html_a65f85814a8290f9797005d3b28e7e5fc"><div class="ttname"><a href="qglobal_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a></div><div class="ttdeci">unsigned char uchar</div><div class="ttdef"><b>Definition:</b> <a href="qglobal_8h_source.html#l00994">qglobal.h:994</a></div></div>
<div class="ttc" id="classQString_html_a8ac5c7669060295d274a0db1c9bcb5ca"><div class="ttname"><a href="classQString.html#a8ac5c7669060295d274a0db1c9bcb5ca">QString::left</a></div><div class="ttdeci">QString left(int n) const Q_REQUIRED_RESULT</div><div class="ttdoc">Returns a substring that contains the n leftmost characters of the string. </div><div class="ttdef"><b>Definition:</b> <a href="qstring_8cpp_source.html#l03664">qstring.cpp:3664</a></div></div>
<div class="ttc" id="classQString_html_aa032d4b5892338beb575a85e59bbbf38"><div class="ttname"><a href="classQString.html#aa032d4b5892338beb575a85e59bbbf38">QString::isEmpty</a></div><div class="ttdeci">bool isEmpty() const</div><div class="ttdoc">Returns true if the string has no characters; otherwise returns false. </div><div class="ttdef"><b>Definition:</b> <a href="qstring_8h_source.html#l00704">qstring.h:704</a></div></div>
<div class="ttc" id="classQMap_html_aacd06ee00e923d9441fde192907f9220"><div class="ttname"><a href="classQMap.html#aacd06ee00e923d9441fde192907f9220">QMap::value</a></div><div class="ttdeci">const T value(const Key &amp;key) const</div><div class="ttdoc">Returns the value associated with the key key. </div><div class="ttdef"><b>Definition:</b> <a href="qmap_8h_source.html#l00499">qmap.h:499</a></div></div>
<div class="ttc" id="classQImage_html_ad1da4ec20201a5f468b4af8c8e7e1b11"><div class="ttname"><a href="classQImage.html#ad1da4ec20201a5f468b4af8c8e7e1b11">QImage::text</a></div><div class="ttdeci">QString text(const QString &amp;key=QString()) const</div><div class="ttdoc">Returns the image text associated with the given key. </div><div class="ttdef"><b>Definition:</b> <a href="qimage_8cpp_source.html#l05736">qimage.cpp:5736</a></div></div>
<div class="ttc" id="classQString_html_afffb887b72dd3ae599f1e6205c5248d9"><div class="ttname"><a href="classQString.html#afffb887b72dd3ae599f1e6205c5248d9">QString::indexOf</a></div><div class="ttdeci">int indexOf(QChar c, int from=0, Qt::CaseSensitivity cs=Qt::CaseSensitive) const</div><div class="ttdef"><b>Definition:</b> <a href="qstring_8cpp_source.html#l02838">qstring.cpp:2838</a></div></div>
<div class="ttc" id="classQLatin1String_html"><div class="ttname"><a href="classQLatin1String.html">QLatin1String</a></div><div class="ttdoc">The QLatin1String class provides a thin wrapper around an US-ASCII/Latin-1 encoded string literal...</div><div class="ttdef"><b>Definition:</b> <a href="qstring_8h_source.html#l00654">qstring.h:654</a></div></div>
<div class="ttc" id="classQString_html_a9491884b49163344c4a03c738125f93d"><div class="ttname"><a href="classQString.html#a9491884b49163344c4a03c738125f93d">QString::toLatin1</a></div><div class="ttdeci">QByteArray toLatin1() const Q_REQUIRED_RESULT</div><div class="ttdoc">Returns a Latin-1 representation of the string as a QByteArray. </div><div class="ttdef"><b>Definition:</b> <a href="qstring_8cpp_source.html#l03993">qstring.cpp:3993</a></div></div>
<div class="ttc" id="classQMap_html_ad25d319573e19f3882c9856a3175842f"><div class="ttname"><a href="classQMap.html#ad25d319573e19f3882c9856a3175842f">QMap::constBegin</a></div><div class="ttdeci">const_iterator constBegin() const</div><div class="ttdoc">Returns a const STL-style iterator pointing to the first item in the map. </div><div class="ttdef"><b>Definition:</b> <a href="qmap_8h_source.html#l00374">qmap.h:374</a></div></div>
<div class="ttc" id="classQByteArray_html_adb3b4e935f60dd123b1b017894901937"><div class="ttname"><a href="classQByteArray.html#adb3b4e935f60dd123b1b017894901937">QByteArray::constData</a></div><div class="ttdeci">const char * constData() const</div><div class="ttdoc">Returns a pointer to the data stored in the byte array. </div><div class="ttdef"><b>Definition:</b> <a href="qbytearray_8h_source.html#l00433">qbytearray.h:433</a></div></div>
<div class="ttc" id="classQString_html_a0e3c8883986091e3e82971b0574fd882"><div class="ttname"><a href="classQString.html#a0e3c8883986091e3e82971b0574fd882">QString::mid</a></div><div class="ttdeci">QString mid(int position, int n=-1) const Q_REQUIRED_RESULT</div><div class="ttdoc">Returns a string that contains n characters of this string, starting at the specified position index...</div><div class="ttdef"><b>Definition:</b> <a href="qstring_8cpp_source.html#l03706">qstring.cpp:3706</a></div></div>
<div class="ttc" id="classQMap_html_af3ce3c91a2c9b4fde417378d7eaef0f2"><div class="ttname"><a href="classQMap.html#af3ce3c91a2c9b4fde417378d7eaef0f2">QMap::constEnd</a></div><div class="ttdeci">const_iterator constEnd() const</div><div class="ttdoc">Returns a const STL-style iterator pointing to the imaginary item after the last item in the map...</div><div class="ttdef"><b>Definition:</b> <a href="qmap_8h_source.html#l00380">qmap.h:380</a></div></div>
<div class="ttc" id="qglobal_8cpp_html_a582bacdb83f410a321e8c00381d6a118"><div class="ttname"><a href="qglobal_8cpp.html#a582bacdb83f410a321e8c00381d6a118">qMemSet</a></div><div class="ttdeci">void * qMemSet(void *dest, int c, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="qglobal_8cpp_source.html#l02509">qglobal.cpp:2509</a></div></div>
<div class="ttc" id="classQString_html_a9c2a096c813373c11643e07e7c23680b"><div class="ttname"><a href="classQString.html#a9c2a096c813373c11643e07e7c23680b">QString::simplified</a></div><div class="ttdeci">QString simplified() const Q_REQUIRED_RESULT</div><div class="ttdoc">Returns a string that has whitespace removed from the start and the end, and that has each sequence o...</div><div class="ttdef"><b>Definition:</b> <a href="qstring_8cpp_source.html#l04415">qstring.cpp:4415</a></div></div>
<div class="ttc" id="classQMap_html_a0cc56ab47ea14af1127ac7399814d289"><div class="ttname"><a href="classQMap.html#a0cc56ab47ea14af1127ac7399814d289">QMap::insert</a></div><div class="ttdeci">iterator insert(const Key &amp;key, const T &amp;value)</div><div class="ttdoc">Inserts a new item with the key key and a value of value. </div><div class="ttdef"><b>Definition:</b> <a href="qmap_8h_source.html#l00559">qmap.h:559</a></div></div>
<div class="ttc" id="qkeysequence_8cpp_html_a35af0be900467fedbb610bd6ea65ed78"><div class="ttname"><a href="qkeysequence_8cpp.html#a35af0be900467fedbb610bd6ea65ed78">key</a></div><div class="ttdeci">int key</div><div class="ttdef"><b>Definition:</b> <a href="qkeysequence_8cpp_source.html#l00395">qkeysequence.cpp:395</a></div></div>
<div class="ttc" id="classQMap_html_a6f715bb4c9b621f97a361eeb92909999"><div class="ttname"><a href="classQMap.html#a6f715bb4c9b621f97a361eeb92909999">QMap::isEmpty</a></div><div class="ttdeci">bool isEmpty() const</div><div class="ttdoc">Returns true if the map contains no items; otherwise returns false. </div><div class="ttdef"><b>Definition:</b> <a href="qmap_8h_source.html#l00203">qmap.h:203</a></div></div>
<div class="ttc" id="classQChar_html_a44b4ebc60a4263918bf8f0dfcea49fa6"><div class="ttname"><a href="classQChar.html#a44b4ebc60a4263918bf8f0dfcea49fa6">QChar::cell</a></div><div class="ttdeci">uchar cell() const</div><div class="ttdoc">Returns the cell (least significant byte) of the Unicode character. </div><div class="ttdef"><b>Definition:</b> <a href="qchar_8h_source.html#l00283">qchar.h:283</a></div></div>
<div class="ttc" id="classQByteArray_html_a0cd331ee1b05147f3173fb85dfcd0ccd"><div class="ttname"><a href="classQByteArray.html#a0cd331ee1b05147f3173fb85dfcd0ccd">QByteArray::size</a></div><div class="ttdeci">int size() const</div><div class="ttdoc">Returns the number of bytes in this byte array. </div><div class="ttdef"><b>Definition:</b> <a href="qbytearray_8h_source.html#l00402">qbytearray.h:402</a></div></div>
<div class="ttc" id="qfontsubset_8cpp_html_a83028518b8b40ed14c1c522b71d2eaa4"><div class="ttname"><a href="qfontsubset_8cpp.html#a83028518b8b40ed14c1c522b71d2eaa4">index</a></div><div class="ttdeci">quint16 index</div><div class="ttdef"><b>Definition:</b> <a href="qfontsubset_8cpp_source.html#l00116">qfontsubset.cpp:116</a></div></div>
<div class="ttc" id="classQByteArray_html_ad8db86227c79f8e8d76811cd2f8aa190"><div class="ttname"><a href="classQByteArray.html#ad8db86227c79f8e8d76811cd2f8aa190">QByteArray::qstrdup</a></div><div class="ttdeci">char * qstrdup(const char *src)</div><div class="ttdoc">Returns a duplicate string. </div><div class="ttdef"><b>Definition:</b> <a href="qbytearray_8cpp_source.html#l00114">qbytearray.cpp:114</a></div></div>
<div class="ttc" id="classQString_html_a523a85a2871b7d22ea87afc82c0733ed"><div class="ttname"><a href="classQString.html#a523a85a2871b7d22ea87afc82c0733ed">QString::split</a></div><div class="ttdeci">QStringList split(const QString &amp;sep, SplitBehavior behavior=KeepEmptyParts, Qt::CaseSensitivity cs=Qt::CaseSensitive) const Q_REQUIRED_RESULT</div><div class="ttdoc">Splits the string into substrings wherever sep occurs, and returns the list of those strings...</div><div class="ttdef"><b>Definition:</b> <a href="qstring_8cpp_source.html#l06526">qstring.cpp:6526</a></div></div>
<div class="ttc" id="classQChar_html_a34a593cf210ef1ab09e09be78bf8ef3e"><div class="ttname"><a href="classQChar.html#a34a593cf210ef1ab09e09be78bf8ef3e">QChar::row</a></div><div class="ttdeci">uchar row() const</div><div class="ttdoc">Returns the row (most significant byte) of the Unicode character. </div><div class="ttdef"><b>Definition:</b> <a href="qchar_8h_source.html#l00284">qchar.h:284</a></div></div>
<div class="ttc" id="structQLatin1Char_html"><div class="ttname"><a href="structQLatin1Char.html">QLatin1Char</a></div><div class="ttdoc">The QLatin1Char class provides an 8-bit ASCII/Latin-1 character. </div><div class="ttdef"><b>Definition:</b> <a href="qchar_8h_source.html#l00055">qchar.h:55</a></div></div>
<div class="ttc" id="classQImage_html_ab0ac9ecde8a77a33d302d5f7485e9db3"><div class="ttname"><a href="classQImage.html#ab0ac9ecde8a77a33d302d5f7485e9db3">QImage::textKeys</a></div><div class="ttdeci">QStringList textKeys() const</div><div class="ttdoc">Returns the text keys for this image. </div><div class="ttdef"><b>Definition:</b> <a href="qimage_8cpp_source.html#l05724">qimage.cpp:5724</a></div></div>
<div class="ttc" id="classQMap_html"><div class="ttname"><a href="classQMap.html">QMap&lt; QString, QString &gt;</a></div></div>
<div class="ttc" id="qobjectdefs_8h_html_a1144b296168b3bd3f9c04d75f4d5b94c"><div class="ttname"><a href="qobjectdefs_8h.html#a1144b296168b3bd3f9c04d75f4d5b94c">text</a></div><div class="ttdeci">#define text</div><div class="ttdef"><b>Definition:</b> <a href="qobjectdefs_8h_source.html#l00080">qobjectdefs.h:80</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a51da633e05bc6b0b5a2f583ae41ab808"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51da633e05bc6b0b5a2f583ae41ab808">&#9670;&nbsp;</a></span>setup_qt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void setup_qt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQImage.html">QImage</a> &amp;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">png_structp&#160;</td>
          <td class="paramname"><em>png_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">png_infop&#160;</td>
          <td class="paramname"><em>info_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>screen_gamma</em> = <code>0.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00227">227</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="qpnghandler_8cpp_source.html#l00464">QPngHandlerPrivate::readPngImage()</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (screen_gamma != 0.0 &amp;&amp; png_get_valid(png_ptr, info_ptr, PNG_INFO_gAMA)) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordtype">double</span> file_gamma;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        png_get_gAMA(png_ptr, info_ptr, &amp;file_gamma);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        png_set_gamma(png_ptr, screen_gamma, file_gamma);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    png_uint_32 width;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    png_uint_32 height;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">int</span> bit_depth;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">int</span> color_type;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    png_bytep trans_alpha = 0;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    png_color_16p trans_color_p = 0;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">int</span> num_trans;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    png_colorp palette = 0;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">int</span> num_palette;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    png_get_IHDR(png_ptr, info_ptr, &amp;width, &amp;height, &amp;bit_depth, &amp;color_type, 0, 0, 0);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    png_set_interlace_handling(png_ptr);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (color_type == PNG_COLOR_TYPE_GRAY) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">// Black &amp; White or 8-bit grayscale</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">if</span> (bit_depth == 1 &amp;&amp; png_get_channels(png_ptr, info_ptr) == 1) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            png_set_invert_mono(png_ptr);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            png_read_update_info(png_ptr, info_ptr);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a62d02eeb27b8f952f8567d3f2c015e32">size</a>() != <a class="code" href="classQSize.html">QSize</a>(width, height) || image.<a class="code" href="classQImage.html#aa0017b14009d6a95b5fda586dc6adc89">format</a>() != <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dab1aa35fb34158e02d1af6272303e3aae">QImage::Format_Mono</a>) {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                image = <a class="code" href="classQImage.html">QImage</a>(width, height, <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dab1aa35fb34158e02d1af6272303e3aae">QImage::Format_Mono</a>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a21c6f77f876ef25965afcd9f412fe5ed">isNull</a>())</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            image.<a class="code" href="classQImage.html#a45e2d9831f138cbb5f3f8795c126ecc6">setColorCount</a>(2);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            image.<a class="code" href="classQImage.html#ab45f7ead4beafabb95c50f44b3d0fa15">setColor</a>(1, <a class="code" href="classQColor.html#a311f9bc75336f7da73ca6fe477ceef25">qRgb</a>(0,0,0));</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            image.<a class="code" href="classQImage.html#ab45f7ead4beafabb95c50f44b3d0fa15">setColor</a>(0, <a class="code" href="classQColor.html#a311f9bc75336f7da73ca6fe477ceef25">qRgb</a>(255,255,255));</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bit_depth == 16 &amp;&amp; png_get_valid(png_ptr, info_ptr, PNG_INFO_tRNS)) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            png_set_expand(png_ptr);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            png_set_strip_16(png_ptr);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            png_set_gray_to_rgb(png_ptr);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a62d02eeb27b8f952f8567d3f2c015e32">size</a>() != <a class="code" href="classQSize.html">QSize</a>(width, height) || image.<a class="code" href="classQImage.html#aa0017b14009d6a95b5fda586dc6adc89">format</a>() != <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dae6a648c88becc4b9993158b57fbdc8e6">QImage::Format_ARGB32</a>) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                image = <a class="code" href="classQImage.html">QImage</a>(width, height, <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dae6a648c88becc4b9993158b57fbdc8e6">QImage::Format_ARGB32</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a21c6f77f876ef25965afcd9f412fe5ed">isNull</a>())</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> (QSysInfo::ByteOrder == QSysInfo::BigEndian)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                png_set_swap_alpha(png_ptr);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            png_read_update_info(png_ptr, info_ptr);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">if</span> (bit_depth == 16)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                png_set_strip_16(png_ptr);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bit_depth &lt; 8)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                png_set_packing(png_ptr);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordtype">int</span> ncols = bit_depth &lt; 8 ? 1 &lt;&lt; bit_depth : 256;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            png_read_update_info(png_ptr, info_ptr);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a62d02eeb27b8f952f8567d3f2c015e32">size</a>() != <a class="code" href="classQSize.html">QSize</a>(width, height) || image.<a class="code" href="classQImage.html#aa0017b14009d6a95b5fda586dc6adc89">format</a>() != <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dabee95196f4682d4f4d1eb1220859e8d2">QImage::Format_Indexed8</a>) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                image = <a class="code" href="classQImage.html">QImage</a>(width, height, <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dabee95196f4682d4f4d1eb1220859e8d2">QImage::Format_Indexed8</a>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a21c6f77f876ef25965afcd9f412fe5ed">isNull</a>())</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            image.<a class="code" href="classQImage.html#a45e2d9831f138cbb5f3f8795c126ecc6">setColorCount</a>(ncols);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ncols; i++) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="qnumeric__p_8h.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a> = i*255/(ncols-1);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                image.<a class="code" href="classQImage.html#ab45f7ead4beafabb95c50f44b3d0fa15">setColor</a>(i, <a class="code" href="classQColor.html#a6af203c3cb74d73d9e43710d0307e7a3">qRgba</a>(c,c,c,0xff));</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">if</span> (png_get_tRNS(png_ptr, info_ptr, &amp;trans_alpha, &amp;num_trans, &amp;trans_color_p) &amp;&amp; trans_color_p) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> g = trans_color_p-&gt;gray;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <span class="keywordflow">if</span> (g &lt; ncols) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    image.<a class="code" href="classQImage.html#ab45f7ead4beafabb95c50f44b3d0fa15">setColor</a>(g, 0);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (color_type == PNG_COLOR_TYPE_PALETTE</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;               &amp;&amp; png_get_PLTE(png_ptr, info_ptr, &amp;palette, &amp;num_palette)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;               &amp;&amp; num_palette &lt;= 256)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// 1-bit and 8-bit color</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">if</span> (bit_depth != 1)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            png_set_packing(png_ptr);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        png_read_update_info(png_ptr, info_ptr);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        png_get_IHDR(png_ptr, info_ptr, &amp;width, &amp;height, &amp;bit_depth, &amp;color_type, 0, 0, 0);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8d">QImage::Format</a> <a class="code" href="qprintengine__ps_8cpp.html#a387137c43ed9616d39ba90e890d181eb">format</a> = bit_depth == 1 ? <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dab1aa35fb34158e02d1af6272303e3aae">QImage::Format_Mono</a> : <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dabee95196f4682d4f4d1eb1220859e8d2">QImage::Format_Indexed8</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a62d02eeb27b8f952f8567d3f2c015e32">size</a>() != <a class="code" href="classQSize.html">QSize</a>(width, height) || image.<a class="code" href="classQImage.html#aa0017b14009d6a95b5fda586dc6adc89">format</a>() != <a class="code" href="qprintengine__ps_8cpp.html#a387137c43ed9616d39ba90e890d181eb">format</a>) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            image = <a class="code" href="classQImage.html">QImage</a>(width, height, format);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a21c6f77f876ef25965afcd9f412fe5ed">isNull</a>())</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        png_get_PLTE(png_ptr, info_ptr, &amp;palette, &amp;num_palette);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        image.<a class="code" href="classQImage.html#a45e2d9831f138cbb5f3f8795c126ecc6">setColorCount</a>(num_palette);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">if</span> (png_get_tRNS(png_ptr, info_ptr, &amp;trans_alpha, &amp;num_trans, &amp;trans_color_p) &amp;&amp; trans_alpha) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">while</span> (i &lt; num_trans) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                image.<a class="code" href="classQImage.html#ab45f7ead4beafabb95c50f44b3d0fa15">setColor</a>(i, <a class="code" href="classQColor.html#a6af203c3cb74d73d9e43710d0307e7a3">qRgba</a>(</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    palette[i].<a class="code" href="namespaceQt.html#a72791987d47f717a18f2c26ec4901f52af117af9b07823c87790c117f6b3d9569">red</a>,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    palette[i].<a class="code" href="namespaceQt.html#a72791987d47f717a18f2c26ec4901f52add848232fb80602a1a1375d0ff732218">green</a>,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    palette[i].<a class="code" href="namespaceQt.html#a72791987d47f717a18f2c26ec4901f52a63323f9fb21fe43ec1c16b2657b238fa">blue</a>,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    trans_alpha[i]</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                   )</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;               );</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                i++;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">while</span> (i &lt; num_palette) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            image.<a class="code" href="classQImage.html#ab45f7ead4beafabb95c50f44b3d0fa15">setColor</a>(i, <a class="code" href="classQColor.html#a6af203c3cb74d73d9e43710d0307e7a3">qRgba</a>(</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                palette[i].<a class="code" href="namespaceQt.html#a72791987d47f717a18f2c26ec4901f52af117af9b07823c87790c117f6b3d9569">red</a>,</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                palette[i].<a class="code" href="namespaceQt.html#a72791987d47f717a18f2c26ec4901f52add848232fb80602a1a1375d0ff732218">green</a>,</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                palette[i].<a class="code" href="namespaceQt.html#a72791987d47f717a18f2c26ec4901f52a63323f9fb21fe43ec1c16b2657b238fa">blue</a>,</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                0xff</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;               )</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;           );</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            i++;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="comment">// 32-bit</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">if</span> (bit_depth == 16)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            png_set_strip_16(png_ptr);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        png_set_expand(png_ptr);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">if</span> (color_type == PNG_COLOR_TYPE_GRAY_ALPHA)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            png_set_gray_to_rgb(png_ptr);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8d">QImage::Format</a> format = <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dae6a648c88becc4b9993158b57fbdc8e6">QImage::Format_ARGB32</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">// Only add filler if no alpha, or we can get 5 channel data.</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">if</span> (!(color_type &amp; PNG_COLOR_MASK_ALPHA)</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            &amp;&amp; !png_get_valid(png_ptr, info_ptr, PNG_INFO_tRNS)) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            png_set_filler(png_ptr, 0xff, QSysInfo::ByteOrder == QSysInfo::BigEndian ?</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                           PNG_FILLER_BEFORE : PNG_FILLER_AFTER);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="comment">// We want 4 bytes, but it isn&#39;t an alpha channel</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            format = <a class="code" href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8da6711d4eda08befec966bcc742678e48c">QImage::Format_RGB32</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a62d02eeb27b8f952f8567d3f2c015e32">size</a>() != <a class="code" href="classQSize.html">QSize</a>(width, height) || image.<a class="code" href="classQImage.html#aa0017b14009d6a95b5fda586dc6adc89">format</a>() != <a class="code" href="qprintengine__ps_8cpp.html#a387137c43ed9616d39ba90e890d181eb">format</a>) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            image = <a class="code" href="classQImage.html">QImage</a>(width, height, format);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keywordflow">if</span> (image.<a class="code" href="classQImage.html#a21c6f77f876ef25965afcd9f412fe5ed">isNull</a>())</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">if</span> (QSysInfo::ByteOrder == QSysInfo::BigEndian)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            png_set_swap_alpha(png_ptr);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        png_read_update_info(png_ptr, info_ptr);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// Qt==ARGB==Big(ARGB)==Little(BGRA)</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> (QSysInfo::ByteOrder == QSysInfo::LittleEndian) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        png_set_bgr(png_ptr);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div><div class="ttc" id="classQImage_html_a810aa2990f23c8aa8dc82c59ba11bd8d"><div class="ttname"><a href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8d">QImage::Format</a></div><div class="ttdeci">Format</div><div class="ttdoc">The following image formats are available in Qt. </div><div class="ttdef"><b>Definition:</b> <a href="qimage_8h_source.html#l00091">qimage.h:91</a></div></div>
<div class="ttc" id="classQImage_html_ab45f7ead4beafabb95c50f44b3d0fa15"><div class="ttname"><a href="classQImage.html#ab45f7ead4beafabb95c50f44b3d0fa15">QImage::setColor</a></div><div class="ttdeci">void setColor(int i, QRgb c)</div><div class="ttdoc">Sets the color at the given index in the color table, to the given to colorValue. ...</div><div class="ttdef"><b>Definition:</b> <a href="qimage_8cpp_source.html#l01850">qimage.cpp:1850</a></div></div>
<div class="ttc" id="classQImage_html_a810aa2990f23c8aa8dc82c59ba11bd8dabee95196f4682d4f4d1eb1220859e8d2"><div class="ttname"><a href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dabee95196f4682d4f4d1eb1220859e8d2">QImage::Format_Indexed8</a></div><div class="ttdef"><b>Definition:</b> <a href="qimage_8h_source.html#l00095">qimage.h:95</a></div></div>
<div class="ttc" id="qnumeric__p_8h_html_aa8bc5d06b176e45541cdfaf9c2c9dfea"><div class="ttname"><a href="qnumeric__p_8h.html#aa8bc5d06b176e45541cdfaf9c2c9dfea">c</a></div><div class="ttdeci">unsigned char c[8]</div><div class="ttdef"><b>Definition:</b> <a href="qnumeric__p_8h_source.html#l00062">qnumeric_p.h:62</a></div></div>
<div class="ttc" id="classQImage_html_a21c6f77f876ef25965afcd9f412fe5ed"><div class="ttname"><a href="classQImage.html#a21c6f77f876ef25965afcd9f412fe5ed">QImage::isNull</a></div><div class="ttdeci">bool isNull() const</div><div class="ttdoc">Returns true if it is a null image, otherwise returns false. </div><div class="ttdef"><b>Definition:</b> <a href="qimage_8cpp_source.html#l01542">qimage.cpp:1542</a></div></div>
<div class="ttc" id="classQImage_html_aa0017b14009d6a95b5fda586dc6adc89"><div class="ttname"><a href="classQImage.html#aa0017b14009d6a95b5fda586dc6adc89">QImage::format</a></div><div class="ttdeci">Format format() const</div><div class="ttdoc">Returns the format of the image. </div><div class="ttdef"><b>Definition:</b> <a href="qimage_8cpp_source.html#l02305">qimage.cpp:2305</a></div></div>
<div class="ttc" id="classQImage_html_a45e2d9831f138cbb5f3f8795c126ecc6"><div class="ttname"><a href="classQImage.html#a45e2d9831f138cbb5f3f8795c126ecc6">QImage::setColorCount</a></div><div class="ttdeci">void setColorCount(int)</div><div class="ttdoc">Resizes the color table to contain colorCount entries. </div><div class="ttdef"><b>Definition:</b> <a href="qimage_8cpp_source.html#l02275">qimage.cpp:2275</a></div></div>
<div class="ttc" id="namespaceQt_html_a72791987d47f717a18f2c26ec4901f52a63323f9fb21fe43ec1c16b2657b238fa"><div class="ttname"><a href="namespaceQt.html#a72791987d47f717a18f2c26ec4901f52a63323f9fb21fe43ec1c16b2657b238fa">Qt::blue</a></div><div class="ttdef"><b>Definition:</b> <a href="qnamespace_8h_source.html#l00114">qnamespace.h:114</a></div></div>
<div class="ttc" id="classQImage_html_a810aa2990f23c8aa8dc82c59ba11bd8dab1aa35fb34158e02d1af6272303e3aae"><div class="ttname"><a href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dab1aa35fb34158e02d1af6272303e3aae">QImage::Format_Mono</a></div><div class="ttdef"><b>Definition:</b> <a href="qimage_8h_source.html#l00093">qimage.h:93</a></div></div>
<div class="ttc" id="classQImage_html"><div class="ttname"><a href="classQImage.html">QImage</a></div><div class="ttdoc">The QImage class provides a hardware-independent image representation that allows direct access to th...</div><div class="ttdef"><b>Definition:</b> <a href="qimage_8h_source.html#l00087">qimage.h:87</a></div></div>
<div class="ttc" id="classQImage_html_a62d02eeb27b8f952f8567d3f2c015e32"><div class="ttname"><a href="classQImage.html#a62d02eeb27b8f952f8567d3f2c015e32">QImage::size</a></div><div class="ttdeci">QSize size() const</div><div class="ttdoc">Returns the size of the image, i. </div><div class="ttdef"><b>Definition:</b> <a href="qimage_8cpp_source.html#l01587">qimage.cpp:1587</a></div></div>
<div class="ttc" id="classQColor_html_a311f9bc75336f7da73ca6fe477ceef25"><div class="ttname"><a href="classQColor.html#a311f9bc75336f7da73ca6fe477ceef25">QColor::qRgb</a></div><div class="ttdeci">QRgb qRgb(int r, int g, int b)</div><div class="ttdoc">Returns the ARGB quadruplet (255, {r}, {g}, {b}). </div><div class="ttdef"><b>Definition:</b> <a href="qrgb_8h_source.html#l00069">qrgb.h:69</a></div></div>
<div class="ttc" id="qprintengine__ps_8cpp_html_a387137c43ed9616d39ba90e890d181eb"><div class="ttname"><a href="qprintengine__ps_8cpp.html#a387137c43ed9616d39ba90e890d181eb">format</a></div><div class="ttdeci">format</div><div class="ttdef"><b>Definition:</b> <a href="qprintengine__ps_8cpp_source.html#l00286">qprintengine_ps.cpp:286</a></div></div>
<div class="ttc" id="classQImage_html_a810aa2990f23c8aa8dc82c59ba11bd8dae6a648c88becc4b9993158b57fbdc8e6"><div class="ttname"><a href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8dae6a648c88becc4b9993158b57fbdc8e6">QImage::Format_ARGB32</a></div><div class="ttdef"><b>Definition:</b> <a href="qimage_8h_source.html#l00097">qimage.h:97</a></div></div>
<div class="ttc" id="namespaceQt_html_a72791987d47f717a18f2c26ec4901f52af117af9b07823c87790c117f6b3d9569"><div class="ttname"><a href="namespaceQt.html#a72791987d47f717a18f2c26ec4901f52af117af9b07823c87790c117f6b3d9569">Qt::red</a></div><div class="ttdef"><b>Definition:</b> <a href="qnamespace_8h_source.html#l00112">qnamespace.h:112</a></div></div>
<div class="ttc" id="classQSize_html"><div class="ttname"><a href="classQSize.html">QSize</a></div><div class="ttdoc">The QSize class defines the size of a two-dimensional object using integer point precision. </div><div class="ttdef"><b>Definition:</b> <a href="qsize_8h_source.html#l00053">qsize.h:53</a></div></div>
<div class="ttc" id="classQImage_html_a810aa2990f23c8aa8dc82c59ba11bd8da6711d4eda08befec966bcc742678e48c"><div class="ttname"><a href="classQImage.html#a810aa2990f23c8aa8dc82c59ba11bd8da6711d4eda08befec966bcc742678e48c">QImage::Format_RGB32</a></div><div class="ttdef"><b>Definition:</b> <a href="qimage_8h_source.html#l00096">qimage.h:96</a></div></div>
<div class="ttc" id="namespaceQt_html_a72791987d47f717a18f2c26ec4901f52add848232fb80602a1a1375d0ff732218"><div class="ttname"><a href="namespaceQt.html#a72791987d47f717a18f2c26ec4901f52add848232fb80602a1a1375d0ff732218">Qt::green</a></div><div class="ttdef"><b>Definition:</b> <a href="qnamespace_8h_source.html#l00113">qnamespace.h:113</a></div></div>
<div class="ttc" id="classQColor_html_a6af203c3cb74d73d9e43710d0307e7a3"><div class="ttname"><a href="classQColor.html#a6af203c3cb74d73d9e43710d0307e7a3">QColor::qRgba</a></div><div class="ttdeci">QRgb qRgba(int r, int g, int b, int a)</div><div class="ttdoc">Returns the ARGB quadruplet ({a}, {r}, {g}, {b}). </div><div class="ttdef"><b>Definition:</b> <a href="qrgb_8h_source.html#l00072">qrgb.h:72</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a351991c84ebb236197d535e32be7cc32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a351991c84ebb236197d535e32be7cc32">&#9670;&nbsp;</a></span>write_png_image()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool write_png_image </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classQImage.html">QImage</a> &amp;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQIODevice.html">QIODevice</a> *&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>quality</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classQString.html">QString</a> &amp;&#160;</td>
          <td class="paramname"><em>description</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qpnghandler_8cpp_source.html#l00915">915</a> of file <a class="el" href="qpnghandler_8cpp_source.html">qpnghandler.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="qpnghandler_8cpp_source.html#l00969">QPngHandler::write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;{</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="classQPNGImageWriter.html">QPNGImageWriter</a> writer(device);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (quality &gt;= 0) {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        quality = <a class="code" href="qglobal_8h.html#a6d0450aa696b2c3684c16be18edd169a">qMin</a>(quality, 100);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        quality = (100-quality) * 9 / 91; <span class="comment">// map [0,100] -&gt; [9,0]</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    }</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    writer.setGamma(gamma);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">return</span> writer.writeImage(image, quality, description);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div><div class="ttc" id="qglobal_8h_html_a6d0450aa696b2c3684c16be18edd169a"><div class="ttname"><a href="qglobal_8h.html#a6d0450aa696b2c3684c16be18edd169a">qMin</a></div><div class="ttdeci">Q_DECL_CONSTEXPR const T &amp; qMin(const T &amp;a, const T &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="qglobal_8h_source.html#l01215">qglobal.h:1215</a></div></div>
<div class="ttc" id="classQPNGImageWriter_html"><div class="ttname"><a href="classQPNGImageWriter.html">QPNGImageWriter</a></div><div class="ttdef"><b>Definition:</b> <a href="qpnghandler_8cpp_source.html#l00149">qpnghandler.cpp:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->

<hr class="footer"/><address class="footer"><small><a href="https://dreamswork.github.io/qt4/">Qt 4.8 Source Code Browser</a></small></address>
</body>
</html>
